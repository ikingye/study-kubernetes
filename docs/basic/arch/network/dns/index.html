<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta name="generator" content="Hugo 0.140.1">
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  K8s DNS
  #



  DNS 策略
  #


Default

The Pod inherits the name resolution configuration from the node that the pods run on


ClusterFirst

Any DNS query that does not match the configured cluster domain suffix, such as “www.kubernetes.io”,
is forwarded to the upstream nameserver inherited from the node.


ClusterFirstWithHostNet

For Pods running with hostNetwork, you should explicitly set its DNS policy “ClusterFirstWithHostNet”


None

It allows a Pod to ignore DNS settings from the Kubernetes environment.
All DNS settings are supposed to be provided using the dnsConfig field in the Pod Spec.




  “Default” is not the default DNS policy.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://kingye.me/study-kubernetes/docs/basic/arch/network/dns/">
  <meta property="og:site_name" content="Kubernetes 学习笔记">
  <meta property="og:title" content="K8s DNS">
  <meta property="og:description" content="K8s DNS # DNS 策略 # Default The Pod inherits the name resolution configuration from the node that the pods run on ClusterFirst Any DNS query that does not match the configured cluster domain suffix, such as “www.kubernetes.io”, is forwarded to the upstream nameserver inherited from the node. ClusterFirstWithHostNet For Pods running with hostNetwork, you should explicitly set its DNS policy “ClusterFirstWithHostNet” None It allows a Pod to ignore DNS settings from the Kubernetes environment. All DNS settings are supposed to be provided using the dnsConfig field in the Pod Spec. “Default” is not the default DNS policy.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="website">
<title>K8s DNS | Kubernetes 学习笔记</title>
<link rel="manifest" href="/study-kubernetes/manifest.json">
<link rel="icon" href="/study-kubernetes/favicon.png" >
<link rel="canonical" href="https://kingye.me/study-kubernetes/docs/basic/arch/network/dns/">
<link rel="stylesheet" href="/study-kubernetes/book.min.45ab58199f84c9a33853fdef2e41664c57a49ca55c9badf2dd2dd071f39975a3.css" integrity="sha256-RatYGZ&#43;EyaM4U/3vLkFmTFeknKVcm63y3S3QcfOZdaM=" crossorigin="anonymous">
  <script defer src="/study-kubernetes/fuse.min.js"></script>
  <script defer src="/study-kubernetes/en.search.min.9a55253f3eaad2159f49149591972a3d2344f91d416be79d368a324b68d3c556.js" integrity="sha256-mlUlPz6q0hWfSRSVkZcqPSNE&#43;R1Ba&#43;edNooyS2jTxVY=" crossorigin="anonymous"></script>
<link rel="alternate" type="application/rss+xml" href="https://kingye.me/study-kubernetes/docs/basic/arch/network/dns/index.xml" title="Kubernetes 学习笔记" />
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>

<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/study-kubernetes/"><span>Kubernetes 学习笔记</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>




<ul>
  <li><a href="https://kingye.me" target="_blank" rel="noopener noreferrer">博客</a></li>
  <li><a href="https://cdn.jsdelivr.net/gh/ikingye/imagehost/picgo/20200417021727.png" target="_blank" rel="noopener noreferrer">公众号</a></li>
  <li><a href="https://github.com/ikingye" target="_blank" rel="noopener noreferrer">Github</a></li>
  <li><a href="https://weibo.com/kingyip15215" target="_blank" rel="noopener noreferrer">微博</a></li>
  <li><a href="https://www.zhihu.com/people/wutongyip" target="_blank" rel="noopener noreferrer">知乎</a></li>
</ul>
<hr />








  



  
  <ul>
    
      
        <li>
          
  
  

  
    <span>第一部分 基础入门</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-bf4e1e1e55ad555e1a397bd066840da9" class="toggle"  />
    <label for="section-bf4e1e1e55ad555e1a397bd066840da9" class="flex justify-between">
      <a href="/study-kubernetes/docs/basic/install/" class="">安装</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-8113a161ea35796f69d80293a7cc1de6" class="toggle"  />
    <label for="section-8113a161ea35796f69d80293a7cc1de6" class="flex justify-between">
      <a href="/study-kubernetes/docs/basic/install/distro/" class="">发行版</a>
    </label>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-22d41bed2b3fe88d1569edc41c694e04" class="toggle"  />
    <label for="section-22d41bed2b3fe88d1569edc41c694e04" class="flex justify-between">
      <a href="/study-kubernetes/docs/basic/install/config/" class="">配置</a>
    </label>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-75fc2f3d0517cd0e5820ebe1d4cde864" class="toggle"  />
    <label for="section-75fc2f3d0517cd0e5820ebe1d4cde864" class="flex justify-between">
      <a href="/study-kubernetes/docs/basic/quick/" class="">1.1 快速上手</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-57e95824ef70a1fb5a2fa8ff70eeb4b2" class="toggle"  />
    <label for="section-57e95824ef70a1fb5a2fa8ff70eeb4b2" class="flex justify-between">
      <a href="/study-kubernetes/docs/basic/concept/" class="">1.2 概念</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/concept/resource/" class="">API 对象</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/concept/resource/pod/" class="">Pod</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/concept/resource/replicaset/" class="">replicaset</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/concept/resource/configmap/" class="">ConfigMap</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/concept/resource/deployment/" class="">Deployment</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/concept/resource/crd/" class="">CRD</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/concept/resource/service/" class="">Service</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/concept/resource/volume/" class="">Volume</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-138294a687f24cf7b80246ce9d560a32" class="toggle" checked />
    <label for="section-138294a687f24cf7b80246ce9d560a32" class="flex justify-between">
      <a href="/study-kubernetes/docs/basic/arch/" class="">1.3 架构</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/arch/network/" class="">K8s 网络</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/arch/network/port/" class="">K8s 端口</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/arch/network/dns/" class="active">K8s DNS</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/arch/network/dns/coredns/" class="">CoreDNS</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/arch/network/dns/kubedns/" class="">KubeDNS</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9e5d14fa0bd9dfd1d572c96bed944f59" class="toggle"  />
    <label for="section-9e5d14fa0bd9dfd1d572c96bed944f59" class="flex justify-between">
      <a href="/study-kubernetes/docs/basic/arch/network/troubleshoot/" class="">故障排查</a>
    </label>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-b49acf61ffaec861fbde55e90c46b8c2" class="toggle"  />
    <label for="section-b49acf61ffaec861fbde55e90c46b8c2" class="flex justify-between">
      <a href="/study-kubernetes/docs/basic/arch/architecture/" class="">架构</a>
    </label>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/arch/component/" class="">组件</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/arch/component/api-server/" class="">api-server</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/arch/component/schedule/" class="">Schedule</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/arch/component/controller-manager/" class="">Controller Manager</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/arch/component/kube-proxy/" class="">Kube-proxy</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/arch/component/kubelet/" class="">Kubelet</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f21c01913e3c8aeb42b2d10b0a86e4a5" class="toggle"  />
    <label for="section-f21c01913e3c8aeb42b2d10b0a86e4a5" class="flex justify-between">
      <a href="/study-kubernetes/docs/basic/other/" class="">1.4 其他</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-5c3c9344196a1ea2079ace6df2e38bb1" class="toggle"  />
    <label for="section-5c3c9344196a1ea2079ace6df2e38bb1" class="flex justify-between">
      <a href="/study-kubernetes/docs/basic/other/version/" class="">版本</a>
    </label>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/basic/other/distro/" class="">发行版</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>第二部分 进阶实战</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3aed5b4da59369a777988b6e7f903dcc" class="toggle"  />
    <label for="section-3aed5b4da59369a777988b6e7f903dcc" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/tool/" class="">2.2 工具</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/advanced/tool/kubectl/" class="">Kubectl</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/advanced/tool/kustomize/" class="">Kustomize</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/advanced/tool/helm/" class="">Helm</a>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-fceaf8732bc4360acf31a4a674d7da0b" class="toggle"  />
    <label for="section-fceaf8732bc4360acf31a4a674d7da0b" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/tool/client-go/" class="">client-go</a>
    </label>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-361119427a98aa78ff659e49a4b2fbe8" class="toggle"  />
    <label for="section-361119427a98aa78ff659e49a4b2fbe8" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/feature/" class="">2.3 功能</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/advanced/feature/operator/" class="">Operator</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/advanced/feature/operator/kubebuilder/" class="">kubebuilder</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/advanced/feature/operator/etcd/" class="">etcd Operator</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ca772e2385abf4f6f15ed0fa9a678ea8" class="toggle"  />
    <label for="section-ca772e2385abf4f6f15ed0fa9a678ea8" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/feature/hpa/" class="">Horizontal Pod Autoscaler</a>
    </label>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-0b02f9bb70c462a714e020018bb93014" class="toggle"  />
    <label for="section-0b02f9bb70c462a714e020018bb93014" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/debug/" class="">2.5 故障排查</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-d2f279c3030137bed6e1977194c7e086" class="toggle"  />
    <label for="section-d2f279c3030137bed6e1977194c7e086" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/debug/pod/" class="">pod 排错</a>
    </label>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-c3ce1d85561677223ac95f79f055828e" class="toggle"  />
    <label for="section-c3ce1d85561677223ac95f79f055828e" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/prof/" class="">2.6 性能</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-802b422ee8ff1335122acdc0a824dd4b" class="toggle"  />
    <label for="section-802b422ee8ff1335122acdc0a824dd4b" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/test/test/" class="">2.7 测试</a>
    </label>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-0a210edcf3ea13baf3de200a61895083" class="toggle"  />
    <label for="section-0a210edcf3ea13baf3de200a61895083" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/eco/" class="">2.8 生态</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-5c5a85e55c877c031d53c5f8939f1d46" class="toggle"  />
    <label for="section-5c5a85e55c877c031d53c5f8939f1d46" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/eco/docker/" class="">Docker</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-7c0583bbb173c6908d1f2238eba5e3b9" class="toggle"  />
    <label for="section-7c0583bbb173c6908d1f2238eba5e3b9" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/eco/docker/quick/" class="">Docker 快速上手</a>
    </label>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-7a074d15138c219b992e407747d943f3" class="toggle"  />
    <label for="section-7a074d15138c219b992e407747d943f3" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/eco/docker/command/" class="">命令</a>
    </label>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-8b691da92c57fcf6c287e30ef4fdd5e5" class="toggle"  />
    <label for="section-8b691da92c57fcf6c287e30ef4fdd5e5" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/eco/docker/version/" class="">版本</a>
    </label>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-bb7319ffeaf15325ca4fda31596e7027" class="toggle"  />
    <label for="section-bb7319ffeaf15325ca4fda31596e7027" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/eco/docker/port/" class="">端口</a>
    </label>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-b260e0673f422ecf30b57225f4f3d4b1" class="toggle"  />
    <label for="section-b260e0673f422ecf30b57225f4f3d4b1" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/eco/docker/image/" class="">镜像</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/advanced/eco/docker/image/alpine/" class="">alpine</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/advanced/eco/docker/containerd/" class="">containerd</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/advanced/eco/docker/dockerfile/" class="">dockerfile</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-79571d15fb59394b47fca2d36cef2c2a" class="toggle"  />
    <label for="section-79571d15fb59394b47fca2d36cef2c2a" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/eco/docker/network/" class="">Docker 网络</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3cf520cf69f183156c6efab66a39553b" class="toggle"  />
    <label for="section-3cf520cf69f183156c6efab66a39553b" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/eco/docker/tutorial/" class="">教程</a>
    </label>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/advanced/eco/docker/attention/" class="">关注项目</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9053dd7a4d9bdf84f3bf92ffdefa99cb" class="toggle"  />
    <label for="section-9053dd7a4d9bdf84f3bf92ffdefa99cb" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/eco/kata/" class="">Kata</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-cf84a2c1fafc5a3448a658ad03b9653b" class="toggle"  />
    <label for="section-cf84a2c1fafc5a3448a658ad03b9653b" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/eco/kubevirt/" class="">KubeVirt</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-6387ac0fb85bf2daffa9db5817776006" class="toggle"  />
    <label for="section-6387ac0fb85bf2daffa9db5817776006" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/eco/k3s/" class="">K3s</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/advanced/eco/oam/" class="">OAM</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/advanced/eco/oam/kubevela/" class="">KubeVela</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ef141f2765248e2ed971af3d18a60205" class="toggle"  />
    <label for="section-ef141f2765248e2ed971af3d18a60205" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/eco/kubeedge/" class="">KubeEdge</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-bb5bae40a558f41dd9f145cc2b8618c8" class="toggle"  />
    <label for="section-bb5bae40a558f41dd9f145cc2b8618c8" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/eco/knative/" class="">Knative</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-773fdc5813e1a947150d2ba4f1d2463a" class="toggle"  />
    <label for="section-773fdc5813e1a947150d2ba4f1d2463a" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/eco/kubeflow/" class="">Kubeflow</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3920f4d1f897360683fc43f95e8f17f9" class="toggle"  />
    <label for="section-3920f4d1f897360683fc43f95e8f17f9" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/eco/kubeless/" class="">Kubeless</a>
    </label>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9c7145b46f3e90d7e265043106b6af7e" class="toggle"  />
    <label for="section-9c7145b46f3e90d7e265043106b6af7e" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/network/" class="">Kubernetes 网络</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-8b42c1acbc5079330cf95b96ec96a4fd" class="toggle"  />
    <label for="section-8b42c1acbc5079330cf95b96ec96a4fd" class="flex justify-between">
      <a href="/study-kubernetes/docs/advanced/network/calico/" class="">Calico</a>
    </label>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/study-kubernetes/docs/design/" class="">第三部分 设计与实现</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-b77961e66966eb368536328c4f776a82" class="toggle"  />
    <label for="section-b77961e66966eb368536328c4f776a82" class="flex justify-between">
      <a href="/study-kubernetes/docs/design/component/" class="">3.1 Kubernetes 组件</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-2ee0b7f1a35426cc3cb9aafdeffb13e1" class="toggle"  />
    <label for="section-2ee0b7f1a35426cc3cb9aafdeffb13e1" class="flex justify-between">
      <a href="/study-kubernetes/docs/design/crd/" class="">3.2 CRD</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-198710dbb7968a78554060e02dfddb1d" class="toggle"  />
    <label for="section-198710dbb7968a78554060e02dfddb1d" class="flex justify-between">
      <a href="/study-kubernetes/docs/design/crd/operator/" class="">3.2.2 Operator</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-7d37bdbdb88f9f8d441a7641e25b6a57" class="toggle"  />
    <label for="section-7d37bdbdb88f9f8d441a7641e25b6a57" class="flex justify-between">
      <a href="/study-kubernetes/docs/design/crd/operator/operatorhub/" class="">OperatorHub</a>
    </label>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f90cb404cb1a692db4fc981fd60788e7" class="toggle"  />
    <label for="section-f90cb404cb1a692db4fc981fd60788e7" class="flex justify-between">
      <a href="/study-kubernetes/docs/design/code/" class="">3.7 源码分析</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-02471f96696ef397764a97f2932059b9" class="toggle"  />
    <label for="section-02471f96696ef397764a97f2932059b9" class="flex justify-between">
      <a href="/study-kubernetes/docs/design/code/1.25.0/" class="">1.25.0</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-aa3650493d98581458e8871c7fc1506b" class="toggle"  />
    <label for="section-aa3650493d98581458e8871c7fc1506b" class="flex justify-between">
      <a href="/study-kubernetes/docs/design/code/1.0.0/" class="">1.0.0</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <span>第四部分 附录</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-285e8d03c88297c6d34f61a4f635dc1b" class="toggle"  />
    <label for="section-285e8d03c88297c6d34f61a4f635dc1b" class="flex justify-between">
      <a href="/study-kubernetes/docs/appendix/tutorial/" class="">4.1 教程</a>
    </label>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-dad8546f658b59e0ef46aab79ac69a7e" class="toggle"  />
    <label for="section-dad8546f658b59e0ef46aab79ac69a7e" class="flex justify-between">
      <a href="/study-kubernetes/docs/appendix/interview/" class="">4.2 面试题</a>
    </label>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-1e4d4286f572ea3991ed87b032e0a1b8" class="toggle"  />
    <label for="section-1e4d4286f572ea3991ed87b032e0a1b8" class="flex justify-between">
      <a href="/study-kubernetes/docs/appendix/attention/" class="">4.3 关注项目</a>
    </label>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>














<hr />
<ul>
  <li><a href="https://cdn.jsdelivr.net/gh/ikingye/imagehost/picgo/20200417022040.png" target="_blank" rel="noopener noreferrer">微信</a></li>
  <li><a href="https://qm.qq.com/cgi-bin/qm/qr?k=EUhzg0UwUksxpQnwEmPngRLezlC6qrnn&jump_from=webapi" target="_blank" rel="noopener noreferrer"><img src="//pub.idqqimg.com/wpa/images/group.png"></a></li>
</ul>


</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/study-kubernetes/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>K8s DNS</strong>

  <label for="toc-control">
    
    <img src="/study-kubernetes/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#dns-策略">DNS 策略</a></li>
    <li><a href="#k8s-中域名是如何被解析的">k8s 中域名是如何被解析的</a>
      <ul>
        <li><a href="#etcresolvconf">/etc/resolv.conf</a></li>
        <li><a href="#nameserver">nameserver</a></li>
        <li><a href="#search-域">search 域</a></li>
        <li><a href="#options">options</a>
          <ul>
            <li><a href="#ndots">ndots</a></li>
            <li><a href="#优化外网域名解析">优化外网域名解析</a>
              <ul>
                <li><a href="#直接使用绝对域名">直接使用绝对域名</a></li>
                <li><a href="#配置-ndots">配置 ndots</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#coredns-vs-kubedns">CoreDNS vs KubeDNS</a></li>
    <li><a href="#为什么-pod-是-corednsservice-是-kube-dns">为什么 pod 是 coredns，service 是 kube-dns？</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article id="article" class="markdown"><h1 id="k8s-dns">
  K8s DNS
  <a class="anchor" href="#k8s-dns">#</a>
</h1>
<hr>
<h2 id="dns-策略">
  DNS 策略
  <a class="anchor" href="#dns-%e7%ad%96%e7%95%a5">#</a>
</h2>
<ul>
<li>Default
<ul>
<li>The Pod inherits the name resolution configuration from the node that the pods run on</li>
</ul>
</li>
<li>ClusterFirst
<ul>
<li>Any DNS query that does not match the configured cluster domain suffix, such as <code>“www.kubernetes.io”</code>,
is forwarded to the upstream nameserver inherited from the node.</li>
</ul>
</li>
<li>ClusterFirstWithHostNet
<ul>
<li>For Pods running with hostNetwork, you should explicitly set its DNS policy “ClusterFirstWithHostNet”</li>
</ul>
</li>
<li>None
<ul>
<li>It allows a Pod to ignore DNS settings from the Kubernetes environment.</li>
<li>All DNS settings are supposed to be provided using the dnsConfig field in the Pod Spec.</li>
</ul>
</li>
</ul>
<blockquote class="book-hint warning">
  <p>“<code>Default</code>” is not the default DNS policy.</p>
<p>If dnsPolicy is not explicitly specified, then “<code>ClusterFirst</code>” is used.</p>

</blockquote>

<p>参考：</p>
<ul>
<li><a href="https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/#pods-dns-policy">Pod&rsquo;s DNS Policy</a></li>
</ul>
<hr>
<h2 id="k8s-中域名是如何被解析的">
  k8s 中域名是如何被解析的
  <a class="anchor" href="#k8s-%e4%b8%ad%e5%9f%9f%e5%90%8d%e6%98%af%e5%a6%82%e4%bd%95%e8%a2%ab%e8%a7%a3%e6%9e%90%e7%9a%84">#</a>
</h2>
<p>在 k8s 中，一个 Pod 如果要访问相同 Namespace 下的 Service（比如 user-svc），那么只需要 <code>curl user-svc</code>。
如果 Pod 和 Service 不在同一域名下，那么就需要在 Service Name 之后添加上 Service 所在的 Namespace（比如 beta），<code>curl user-svc.beta</code>。
那么 k8s 是如何知道这些域名是内部域名并为他们做解析的呢？</p>
<p>无论是在 宿主机 或者是在 k8s 集群中，DNS 解析会依赖这个三个文件</p>
<ul>
<li><code>/etc/host.conf</code></li>
<li><code>/etc/hosts</code></li>
<li><code>/etc/resolv.conf</code></li>
</ul>
<h3 id="etcresolvconf">
  /etc/resolv.conf
  <a class="anchor" href="#etcresolvconf">#</a>
</h3>
<p>resolv.conf 是 Pod 在 <code>dnsPolicy: ClusterFirst</code> 的情况下，k8s 为其自动生成的。
在该 Pod 内请求的所有的域名解析都需要经过 <code>DNS Service</code> 进行解析，不管是集群内部域名还是外部域名。</p>
<p>每行都会以一个关键字开头，然后跟配置参数。</p>
<p>在集群中主要使用到的关键词有 3 个</p>
<ul>
<li>nameserver 定义 DNS 服务器的 IP 地址（Kube-DNS 的 Service IP）</li>
<li>search 定义域名的搜索列表，当查询的域名中包含的 <code>.</code> 的数量少于 options.ndots 的值时，会依次匹配列表中的每个值</li>
<li>options 定义域名查找时的配置信息</li>
</ul>
<p>nameserver、search 和 options 都是可以通过 dnsConfig 字段进行配置的，详细参考<a href="https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/">官方文档</a></p>
<p>例如</p>
<pre tabindex="0"><code>nameserver 10.250.0.10
search default.svc.cluster.local svc.cluster.local cluster.local
options ndots:5
</code></pre><h3 id="nameserver">
  nameserver
  <a class="anchor" href="#nameserver">#</a>
</h3>
<p>nameserver 所对应的地址正是 DNS Service 的 Cluster IP（该值在启动 <code>kubelet</code> 的时候，通过 <code>clusterDNS</code> 指定）。</p>
<h3 id="search-域">
  search 域
  <a class="anchor" href="#search-%e5%9f%9f">#</a>
</h3>
<p>search 域默认包含了 <code>namespace.svc.cluster.local</code>、<code>svc.cluster.local</code> 和 <code>cluster.local</code> 三种。</p>
<p>当我们在 Pod 中访问 <code>a</code> Service 时（ <code>curl a</code> ），会选择 nameserver 10.250.0.10 进行解析，然后依次带入 search 域进行 DNS 查找，直到找到为止。</p>
<pre tabindex="0"><code>$ curl a
a.default.svc.cluster.local
</code></pre><p>显然因为 Pod 和 a Service 在同一 Namespace 下，所以第一次 lookup 就能找到。</p>
<p>如果 Pod 要访问不同 Namespace（例如： beta ）下的 Service b （ curl b.beta ），会经过两次 DNS 查找，分别是</p>
<pre tabindex="0"><code>$ curl b.beta
b.beta.default.svc.cluster.local # Not Found
b.beta.svc.cluster.local # Found
</code></pre><p>正是因为 search 的顺序性，所以访问同一 Namespace 下的 Service， curl a 是要比 curl a.default 的效率更高的，因为后者多经过了一次 DNS 解析。</p>
<pre tabindex="0"><code>$ curl a
a.default.svc.cluster.local # Found

$ curl a.default
b.default.default.svc.cluster.local # Not Found
b.default.svc.cluster.local # Found
</code></pre><h3 id="options">
  options
  <a class="anchor" href="#options">#</a>
</h3>
<h4 id="ndots">
  ndots
  <a class="anchor" href="#ndots">#</a>
</h4>
<p>ndots:5，表示：</p>
<ul>
<li>如果需要 lookup 的 Domain 中包含少于 5 个 <code>.</code> ，那么将会被当做非绝对域名，</li>
<li>如果需要查询的 Domain 中包含大于或等于 5 个 <code>.</code> ，那么就会被当做绝对域名。</li>
</ul>
<p>如果是绝对域名则不会走 search 域，</p>
<p>如果是非绝对域名，就会按照 search 域中进行逐一匹配查询，
如果 search 走完了都没有找到，那么就会使用原域名进行查找。</p>
<h4 id="优化外网域名解析">
  优化外网域名解析
  <a class="anchor" href="#%e4%bc%98%e5%8c%96%e5%a4%96%e7%bd%91%e5%9f%9f%e5%90%8d%e8%a7%a3%e6%9e%90">#</a>
</h4>
<p>在真正解析 <a href="http://iftech.io">http://iftech.io</a> 之前，经历了</p>
<pre tabindex="0"><code>iftech.io.default.svc.cluster.local
-&gt; iftech.io.svc.cluster.local
-&gt; iftech.io.cluster.local
-&gt; iftech.io
</code></pre><p>这样也就意味着前 3 次 DNS 请求是浪费的，没有意义的。</p>
<h5 id="直接使用绝对域名">
  直接使用绝对域名
  <a class="anchor" href="#%e7%9b%b4%e6%8e%a5%e4%bd%bf%e7%94%a8%e7%bb%9d%e5%af%b9%e5%9f%9f%e5%90%8d">#</a>
</h5>
<p>这是最简单直接的优化方式，可以直接在要访问的域名后面加上 <code>.</code> 如：<code>iftech.io.</code> ，这样就可以避免走 search 域进行匹配。</p>
<h5 id="配置-ndots">
  配置 ndots
  <a class="anchor" href="#%e9%85%8d%e7%bd%ae-ndots">#</a>
</h5>
<p>比如配置 <code>ndots:1</code>，<code>iftech.io.</code> 就会使用原域名进行查找。</p>
<p><img src="https://pic2.zhimg.com/v2-c6350769871dc7610b22c5cbcd37f8f9_r.jpg" alt="" /></p>
<hr>
<h2 id="coredns-vs-kubedns">
  CoreDNS vs KubeDNS
  <a class="anchor" href="#coredns-vs-kubedns">#</a>
</h2>
<p>在 kube-dns 中，一个 pod 内使用了数个容器：kubedns、dnsmasq 和 sidecar。</p>
<ul>
<li>kubedns 容器监视 Kubernetes API 并基于 Kubernetes DNS 规范提供 DNS 记录，</li>
<li>dnsmasq 提供缓存和存根域支持，</li>
<li>sidecar 提供指标和健康检查。</li>
</ul>
<p>此设置会导致一些问题随着时间的推移而出现。首先，dnsmasq 中的安全漏洞导致过去需要发布 Kubernetes 安全补丁。
此外，由于 dnsmasq 处理存根域，但 kubedns 处理 External Services，因此你无法在外部服务中使用存根域，这非常限制该功能（参阅 dns＃131）。</p>
<p>在 CoreDNS 中，所有这些功能都在一个容器中完成 —— 该容器运行用 Go 编写的进程。
启用的不同插件来复制（并增强）kube-dns 中的功能。</p>
<h2 id="为什么-pod-是-corednsservice-是-kube-dns">
  为什么 pod 是 coredns，service 是 kube-dns？
  <a class="anchor" href="#%e4%b8%ba%e4%bb%80%e4%b9%88-pod-%e6%98%af-corednsservice-%e6%98%af-kube-dns">#</a>
</h2>
<p>其实是 CoreDNS</p>
<p>CoreDNS is default from <strong>K8S 1.11</strong>. For previous installations it&rsquo;s kube-dns.</p>
<p>看 <code>image</code>，其他都是 metadata，不重要</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ k describe pod coredns-6967fb4995-76trs -n kube-system | grep -i <span style="color:#e6db74">&#34;image&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Image:         registry.cn-hangzhou.aliyuncs.com/google_containers/coredns:1.3.1
</span></span></code></pre></div><p>问题详情</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ k cluster-info
</span></span><span style="display:flex;"><span>Kubernetes master is running at https://192.168.99.102:8443
</span></span><span style="display:flex;"><span>KubeDNS is running at https://192.168.99.102:8443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ k get po -n kube-system
</span></span><span style="display:flex;"><span>NAME                               READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>coredns-6967fb4995-76trs           1/1     Running   <span style="color:#ae81ff">6</span>          32d
</span></span><span style="display:flex;"><span>coredns-6967fb4995-grnzj           1/1     Running   <span style="color:#ae81ff">6</span>          32d
</span></span><span style="display:flex;"><span>etcd-minikube                      1/1     Running   <span style="color:#ae81ff">3</span>          32d
</span></span><span style="display:flex;"><span>kube-addon-manager-minikube        1/1     Running   <span style="color:#ae81ff">3</span>          32d
</span></span><span style="display:flex;"><span>kube-apiserver-minikube            1/1     Running   <span style="color:#ae81ff">3</span>          32d
</span></span><span style="display:flex;"><span>kube-controller-manager-minikube   1/1     Running   <span style="color:#ae81ff">3</span>          32d
</span></span><span style="display:flex;"><span>kube-proxy-z765q                   1/1     Running   <span style="color:#ae81ff">3</span>          32d
</span></span><span style="display:flex;"><span>kube-scheduler-minikube            1/1     Running   <span style="color:#ae81ff">3</span>          32d
</span></span><span style="display:flex;"><span>storage-provisioner                1/1     Running   <span style="color:#ae81ff">5</span>          32d
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ k get svc -n kube-system
</span></span><span style="display:flex;"><span>NAME       TYPE        CLUSTER-IP   EXTERNAL-IP   PORT<span style="color:#f92672">(</span>S<span style="color:#f92672">)</span>                  AGE
</span></span><span style="display:flex;"><span>kube-dns   ClusterIP   10.96.0.10   &lt;none&gt;        53/UDP,53/TCP,9153/TCP   32d
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>$ k describe svc/kube-dns -n kube-system
</span></span><span style="display:flex;"><span>Name:              kube-dns
</span></span><span style="display:flex;"><span>Namespace:         kube-system
</span></span><span style="display:flex;"><span>Labels:            k8s-app<span style="color:#f92672">=</span>kube-dns
</span></span><span style="display:flex;"><span>                   kubernetes.io/cluster-service<span style="color:#f92672">=</span>true
</span></span><span style="display:flex;"><span>                   kubernetes.io/name<span style="color:#f92672">=</span>KubeDNS
</span></span><span style="display:flex;"><span>Annotations:       prometheus.io/port: <span style="color:#ae81ff">9153</span>
</span></span><span style="display:flex;"><span>                   prometheus.io/scrape: true
</span></span><span style="display:flex;"><span>Selector:          k8s-app<span style="color:#f92672">=</span>kube-dns
</span></span><span style="display:flex;"><span>Type:              ClusterIP
</span></span><span style="display:flex;"><span>IP:                10.96.0.10
</span></span><span style="display:flex;"><span>Port:              dns  53/UDP
</span></span><span style="display:flex;"><span>TargetPort:        53/UDP
</span></span><span style="display:flex;"><span>Endpoints:         172.17.0.2:53,172.17.0.3:53
</span></span><span style="display:flex;"><span>Port:              dns-tcp  53/TCP
</span></span><span style="display:flex;"><span>TargetPort:        53/TCP
</span></span><span style="display:flex;"><span>Endpoints:         172.17.0.2:53,172.17.0.3:53
</span></span><span style="display:flex;"><span>Port:              metrics  9153/TCP
</span></span><span style="display:flex;"><span>TargetPort:        9153/TCP
</span></span><span style="display:flex;"><span>Endpoints:         172.17.0.2:9153,172.17.0.3:9153
</span></span><span style="display:flex;"><span>Session Affinity:  None
</span></span><span style="display:flex;"><span>Events:            &lt;none&gt;
</span></span></code></pre></div><p>参考：</p>
<ul>
<li><a href="https://stackoverflow.com/questions/52761135/kubernetes-kube-dns-vs-coredns">Kubernetes: Kube-DNS vs CoreDNS</a></li>
</ul>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">


  <div><a class="flex align-center" href="https://github.com/ikingye/study-kubernetes/commit/fc583647bd6dcbd11d9cde2174761b02fe7ed2cb" title='Last modified by yewang | 2022-04-22' target="_blank" rel="noopener">
      <img src="/study-kubernetes/svg/calendar.svg" class="book-icon" alt="" />
      <span>2022-04-22</span>
    </a>
  </div>




</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        <div>
    <br>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <p><span id="busuanzi_container_page_pv">本文访问量 <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> 次</span></p>
    <p><span id="busuanzi_container_site_pv">本站总访问量 <span id="busuanzi_value_site_pv"><i class="fa fa-spinner fa-spin"></i></span> 次</span></p>
    <p><span id="busuanzi_container_site_uv">本站总访客数 <span id="busuanzi_value_site_uv"><i class="fa fa-spinner fa-spin"></i></span> 人</span></p>
</div>



      </footer>

      
  
  <div class="book-comments">
<script src="https://utteranc.es/client.js"
  repo="ikingye/study-kubernetes"
  issue-term="pathname"
  theme="github-light"
  crossorigin="anonymous"
  async
></script>

<div id="footer">
  <p>
    <a href="https://kingye.me">叶王</a> &copy; 2013-2024
    版权所有。如果本文档对你有所帮助，可以<a
      href="https://cdn.jsdelivr.net/gh/ikingye/imagehost/picgo/20200428110046.png"
      target="_blank"
      rel="noopener noreferrer"
      >请作者喝饮料</a
    >。
  </p>
</div>

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#dns-策略">DNS 策略</a></li>
    <li><a href="#k8s-中域名是如何被解析的">k8s 中域名是如何被解析的</a>
      <ul>
        <li><a href="#etcresolvconf">/etc/resolv.conf</a></li>
        <li><a href="#nameserver">nameserver</a></li>
        <li><a href="#search-域">search 域</a></li>
        <li><a href="#options">options</a>
          <ul>
            <li><a href="#ndots">ndots</a></li>
            <li><a href="#优化外网域名解析">优化外网域名解析</a>
              <ul>
                <li><a href="#直接使用绝对域名">直接使用绝对域名</a></li>
                <li><a href="#配置-ndots">配置 ndots</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#coredns-vs-kubedns">CoreDNS vs KubeDNS</a></li>
    <li><a href="#为什么-pod-是-corednsservice-是-kube-dns">为什么 pod 是 coredns，service 是 kube-dns？</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>

</html>












